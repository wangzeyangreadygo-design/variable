<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>变量管理中心 - 风控决策引擎</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Sidebar Active State */
        .sidebar-active { @apply bg-blue-50 text-blue-600 border-r-2 border-blue-600; }
        .card-hover { @apply hover:shadow-md hover:border-blue-200 transition duration-200; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Syntax Highlighting Mock */
        .token-keyword { color: #c678dd; }
        .token-fn { color: #61afef; }
        .token-str { color: #98c379; }
        .token-comment { color: #7f848e; font-style: italic; }
        .token-num { color: #d19a66; }

        /* Animation */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Icons ---
        const Icon = ({ children, size = 18, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );
        // 使用简单的 SVG 路径以确保兼容性
        const Icons = {
            Server: <Icon><rect width="20" height="8" x="2" y="2" rx="2" ry="2"/><rect width="20" height="8" x="2" y="14" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/></Icon>,
            Database: <Icon><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></Icon>,
            Settings: <Icon><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></Icon>,
            Zap: <Icon><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></Icon>,
            Globe: <Icon><circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></Icon>,
            Function: <Icon><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M9 17c2 0 2.8-1 2.8-2.8V10c0-2 1-3.3 3.2-3"/><path d="M9 11.2h5.7"/></Icon>,
            Search: <Icon><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></Icon>,
            ArrowLeft: <Icon><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></Icon>,
            Play: <Icon><polygon points="5 3 19 12 5 21 5 3"/></Icon>,
            Code: <Icon><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></Icon>,
            Link: <Icon><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></Icon>,
            History: <Icon><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></Icon>,
            X: <Icon><path d="M18 6 6 18"/><path d="m6 6 12 12"/></Icon>
        };

        // --- Data Definitions ---
        
        const BIZ_LINES = ['全部业务', '信贷审批', '反欺诈 (Fraud)', '交易风控'];

        // 变量类型定义：严格对齐架构
        const VAR_TYPES = {
            REALTIME_REDIS: { 
                id: 'REALTIME_REDIS', label: '实时变量 (Redis)', icon: Icons.Zap, 
                color: 'text-amber-600 bg-amber-50 border-amber-200',
                desc: '读取 Redis 中实时计算累积的特征',
                codeLabel: 'Redis Key Pattern'
            },
            OFFLINE_DB: { 
                id: 'OFFLINE_DB', label: '离线变量 (MySQL)', icon: Icons.Database, 
                color: 'text-slate-600 bg-slate-50 border-slate-200',
                desc: '读取 MySQL/TiDB 中的 T-1 画像数据',
                codeLabel: 'SQL Query'
            },
            EXTERNAL_API: { 
                id: 'EXTERNAL_API', label: '外部变量 (API)', icon: Icons.Globe, 
                color: 'text-blue-600 bg-blue-50 border-blue-200',
                desc: '实时调用第三方 HTTP 接口',
                codeLabel: 'API Path & Config'
            },
            DERIVED_SCRIPT: { 
                id: 'DERIVED_SCRIPT', label: '衍生变量 (Script)', icon: Icons.Function, 
                color: 'text-purple-600 bg-purple-50 border-purple-200',
                desc: '基于已有的基础变量进行二次加工',
                codeLabel: 'Calculation Logic (Groovy/Go)'
            }
        };

        // 模拟数据源 (Part 1 的产物)
        const MOCK_SOURCES = [
            { id: 'SRC_001', name: '实时特征库 (Redis)', type: 'REDIS', status: 'Active' },
            { id: 'SRC_002', name: '离线数仓 (MySQL)', type: 'DB', status: 'Active' },
            { id: 'SRC_003', name: '征信中心 (HTTP)', type: 'HTTP', status: 'Active' },
        ];

        // 模拟变量数据
        const MOCK_VARS = [
            { id: 'V_001', name: 'user_1h_amt_sum', cnName: '用户近1小时累计金额', type: 'REALTIME_REDIS', biz: '反欺诈 (Fraud)', sourceId: 'SRC_001', content: 'fraud:u:{uid}:1h:sum', status: 'Active', version: 'v1.5' },
            { id: 'V_002', name: 'user_30d_avg_amt', cnName: '用户近30日日均金额', type: 'OFFLINE_DB', biz: '信贷审批', sourceId: 'SRC_002', content: 'SELECT avg_amt FROM user_profile WHERE uid = ?', status: 'Active', version: 'v2.0' },
            { id: 'V_003', name: 'ext_risk_score', cnName: '第三方风控评分', type: 'EXTERNAL_API', biz: '信贷审批', sourceId: 'SRC_003', content: '/v2/query/score', status: 'Testing', version: 'v1.0' },
            { id: 'V_004', name: 'burst_ratio', cnName: '突发大额系数', type: 'DERIVED_SCRIPT', biz: '反欺诈 (Fraud)', sourceId: null, content: 'return V_001 / V_002', status: 'Draft', version: 'v0.1' },
        ];

        // --- Sidebar Component ---
        const Sidebar = () => (
            <div className="w-64 bg-white h-screen border-r border-slate-200 flex flex-col z-10 shrink-0">
                <div className="h-16 flex items-center px-6 border-b border-slate-100">
                    <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white mr-3 shadow-md">
                        {Icons.Server}
                    </div>
                    <span className="font-bold text-slate-800 tracking-tight">风控决策引擎</span>
                </div>
                <div className="p-4">
                    <div className="text-xs font-bold text-slate-400 uppercase mb-2 px-2">决策基石</div>
                    <div className="space-y-1">
                        <div className="px-4 py-2.5 rounded-lg flex items-center cursor-pointer text-slate-600 hover:bg-slate-50 transition">
                            <span className="mr-3">{Icons.Database}</span> 数据源管理
                        </div>
                        <div className="px-4 py-2.5 rounded-lg flex items-center cursor-pointer sidebar-active">
                            <span className="mr-3">{Icons.Settings}</span> 变量中心
                        </div>
                    </div>
                </div>
            </div>
        );

        // --- Editor Component ---
        const VariableEditor = ({ variable, onBack, onUpdateStatus }) => {
            const [isTesting, setIsTesting] = useState(false);
            const [testResult, setTestResult] = useState(null);
            const [showDiff, setShowDiff] = useState(false);
            
            const typeConfig = VAR_TYPES[variable.type];
            const sourceInfo = MOCK_SOURCES.find(s => s.id === variable.sourceId);

            const handleRunTest = () => {
                setIsTesting(true);
                setTestResult(null);
                // 模拟网络延迟
                setTimeout(() => {
                    setIsTesting(false);
                    setTestResult({
                        success: true,
                        latency: '12ms',
                        value: variable.type === 'DERIVED_SCRIPT' ? 4.5 : 12000.50,
                        source: sourceInfo?.name || 'Engine Calculation',
                        log: 'Successfully fetched from source.'
                    });
                }, 1000);
            };

            // 渲染不同类型的编辑器内容
            const renderCodePreview = () => {
                if (variable.type === 'REALTIME_REDIS') {
                    return (
                        <>
                            <span className="token-comment">// Redis Key Pattern</span><br/>
                            <span className="token-keyword">GET</span> <span className="token-str">"{variable.content}"</span>
                        </>
                    );
                }
                if (variable.type === 'OFFLINE_DB') {
                    return (
                        <>
                            <span className="token-keyword">SELECT</span> avg_amt <span className="token-keyword">FROM</span> user_profile <br/>
                            <span className="token-keyword">WHERE</span> uid = <span className="token-num">?</span>
                        </>
                    );
                }
                if (variable.type === 'DERIVED_SCRIPT') {
                    return (
                        <>
                            <span className="token-comment">// Groovy Script</span><br/>
                            <span className="token-keyword">def</span> v1 = Context.get(<span className="token-str">"user_1h_amt_sum"</span>)<br/>
                            <span className="token-keyword">def</span> v2 = Context.get(<span className="token-str">"user_30d_avg_amt"</span>)<br/>
                            <span className="token-keyword">if</span> (v2 == 0) <span className="token-keyword">return</span> 0<br/>
                            <span className="token-keyword">return</span> v1 / v2
                        </>
                    );
                }
                return <span className="token-str">"{variable.content}"</span>;
            };

            return (
                <div className="flex flex-col h-full bg-slate-50 relative animate-fade-in">
                    {/* Header */}
                    <div className="h-16 border-b border-slate-200 flex justify-between items-center px-6 shrink-0 bg-white shadow-sm z-10">
                        <div className="flex items-center gap-4">
                            <button onClick={onBack} className="p-2 hover:bg-slate-100 rounded-lg text-slate-500 transition">{Icons.ArrowLeft}</button>
                            <div>
                                <div className="flex items-center gap-3">
                                    <h2 className="text-lg font-bold text-slate-800">{variable.name}</h2>
                                    <span className={`px-2 py-0.5 rounded text-xs font-medium border flex items-center gap-1 ${typeConfig.color}`}>
                                        {typeConfig.icon} {typeConfig.label}
                                    </span>
                                </div>
                                <div className="text-xs text-slate-500 mt-0.5">{variable.cnName} · {variable.biz}</div>
                            </div>
                        </div>
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-2 bg-slate-100 px-3 py-1.5 rounded-lg border border-slate-200">
                                <label className="text-xs font-bold text-slate-500">状态:</label>
                                <select 
                                    className="bg-transparent text-xs font-bold text-slate-700 outline-none cursor-pointer"
                                    value={variable.status}
                                    onChange={(e) => onUpdateStatus(variable.id, e.target.value)}
                                >
                                    <option value="Draft">Draft (草稿)</option>
                                    <option value="Testing">Testing (测试中)</option>
                                    <option value="Active">Active (已生效)</option>
                                    <option value="Disabled">Disabled (已停用)</option>
                                </select>
                                <span className={`w-2 h-2 rounded-full ${
                                    variable.status === 'Active' ? 'bg-green-500' : 
                                    variable.status === 'Testing' ? 'bg-blue-500' : 'bg-slate-400'
                                }`}></span>
                            </div>
                            <button className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-sm transition">
                                保存配置
                            </button>
                        </div>
                    </div>

                    {/* Content Grid */}
                    <div className="flex-1 overflow-hidden flex p-6 gap-6">
                        {/* LEFT: Config */}
                        <div className="flex-1 flex flex-col gap-6 overflow-y-auto">
                            {/* Dependency Card */}
                            <div className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                <h3 className="text-sm font-bold text-slate-700 mb-4 flex items-center gap-2">
                                    {Icons.Link} <span className="text-slate-400">上游数据依赖</span>
                                </h3>
                                <div className="flex items-center gap-4">
                                    <div className="flex-1">
                                        <label className="text-xs font-semibold text-slate-500 mb-1.5 block">绑定数据源</label>
                                        <div className="flex items-center gap-3 p-3 bg-slate-50 border border-slate-200 rounded-lg">
                                            {sourceInfo ? (
                                                <>
                                                    <div className={`w-8 h-8 rounded flex items-center justify-center shrink-0 ${sourceInfo.type === 'REDIS' ? 'bg-orange-100 text-orange-600' : 'bg-blue-100 text-blue-600'}`}>
                                                        {sourceInfo.type === 'REDIS' ? Icons.Zap : Icons.Database}
                                                    </div>
                                                    <div>
                                                        <div className="text-sm font-bold text-slate-700">{sourceInfo.name}</div>
                                                        <div className="text-xs text-slate-400 font-mono">{sourceInfo.id}</div>
                                                    </div>
                                                    <div className="ml-auto text-xs font-bold text-green-600 bg-green-50 px-2 py-0.5 rounded border border-green-100">
                                                        已连接
                                                    </div>
                                                </>
                                            ) : (
                                                <div className="text-sm text-slate-400 italic py-1">此变量为纯计算衍生，无直接物理数据源</div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Code Editor */}
                            <div className="flex-1 bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col min-h-[300px]">
                                <div className="px-4 py-2 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                                    <span className="text-xs font-bold text-slate-500 flex items-center gap-2">{Icons.Code} {typeConfig.codeLabel}</span>
                                </div>
                                <div className="flex-1 bg-[#1e1e1e] p-4 font-mono text-sm text-slate-300 overflow-auto rounded-b-xl">
                                    {renderCodePreview()}
                                </div>
                            </div>
                        </div>

                        {/* RIGHT: Tools */}
                        <div className="w-80 flex flex-col gap-6 shrink-0">
                            {/* Test Console */}
                            <div className="bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col flex-1 overflow-hidden">
                                <div className="p-4 border-b border-slate-100">
                                    <h3 className="text-sm font-bold text-slate-700">在线试运行</h3>
                                    <p className="text-xs text-slate-400 mt-1">模拟入参验证计算结果</p>
                                </div>
                                <div className="p-4 flex-1 flex flex-col gap-4 overflow-y-auto">
                                    <div>
                                        <label className="text-xs font-semibold text-slate-500 mb-1.5 block">Mock 入参 (JSON)</label>
                                        <textarea 
                                            className="w-full h-24 border border-slate-300 rounded-lg px-3 py-2 text-xs font-mono focus:ring-2 focus:ring-blue-500 outline-none resize-none"
                                            defaultValue={`{\n  "uid": "U10086",\n  "amount": 5000\n}`}
                                        ></textarea>
                                    </div>
                                    <button 
                                        onClick={handleRunTest}
                                        disabled={isTesting}
                                        className={`w-full py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition ${isTesting ? 'bg-slate-100 text-slate-400 cursor-wait' : 'bg-green-600 text-white hover:bg-green-700 shadow-md'}`}
                                    >
                                        {isTesting ? '计算中...' : <>{Icons.Play} 立即运行</>}
                                    </button>

                                    {testResult && (
                                        <div className="animate-fade-in bg-slate-900 rounded-lg p-3 font-mono text-xs overflow-hidden">
                                            <div className="flex justify-between border-b border-slate-700 pb-2 mb-2">
                                                <span className="text-slate-400">Result</span>
                                                <span className="text-green-400">{testResult.latency}</span>
                                            </div>
                                            <div className="text-green-400 font-bold text-lg mb-1">{testResult.value}</div>
                                            <div className="text-slate-500 text-[10px] truncate">// Src: {testResult.source}</div>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* Version History */}
                            <div className="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden h-48 flex flex-col">
                                <div className="p-3 border-b border-slate-100 bg-slate-50/50">
                                    <h3 className="text-xs font-bold text-slate-500">版本历史</h3>
                                </div>
                                <div className="overflow-y-auto">
                                    {[variable.version, 'v1.0', 'v0.9'].map((v, i) => (
                                        <div key={`${v}-${i}`} className="flex justify-between items-center px-4 py-3 hover:bg-slate-50 border-b border-slate-50 last:border-0 cursor-pointer" onClick={() => setShowDiff(true)}>
                                            <div className="flex items-center gap-2">
                                                <span className={`w-1.5 h-1.5 rounded-full ${i===0 ? 'bg-green-500' : 'bg-slate-300'}`}></span>
                                                <span className="text-xs font-bold text-slate-700 font-mono">{v}</span>
                                            </div>
                                            <span className="text-[10px] text-blue-600 hover:underline">查看代码</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Diff Modal */}
                    {showDiff && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm" onClick={() => setShowDiff(false)}>
                            <div className="bg-white rounded-xl shadow-2xl w-[600px] overflow-hidden animate-fade-in" onClick={e => e.stopPropagation()}>
                                <div className="px-5 py-3 border-b border-slate-100 flex justify-between items-center">
                                    <h3 className="font-bold text-slate-800">版本差异对比 ({variable.version} vs Previous)</h3>
                                    <button onClick={() => setShowDiff(false)} className="text-slate-400 hover:text-slate-600">{Icons.X}</button>
                                </div>
                                <div className="p-4 bg-[#1e1e1e] font-mono text-xs text-slate-300 h-64 overflow-auto">
                                    <div className="flex gap-4 mb-2 opacity-50"><span className="w-6 text-right select-none">1</span> <span>// Previous Logic</span></div>
                                    <div className="flex gap-4 mb-2 text-red-400 bg-red-900/20"><span className="w-6 text-right select-none">-</span> <span>return v1 / 100</span></div>
                                    <div className="flex gap-4 mb-2 text-green-400 bg-green-900/20"><span className="w-6 text-right select-none">+</span> <span>return v1 / v2</span></div>
                                    <div className="flex gap-4 mb-2 opacity-50"><span className="w-6 text-right select-none">4</span> <span>// End</span></div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [view, setView] = useState('LIST'); // LIST, EDITOR
            const [selectedBiz, setSelectedBiz] = useState('全部业务');
            const [variables, setVariables] = useState(MOCK_VARS);
            const [editingVarId, setEditingVarId] = useState(null);

            const activeVar = variables.find(v => v.id === editingVarId);

            const handleUpdateStatus = (id, newStatus) => {
                setVariables(vars => vars.map(v => v.id === id ? {...v, status: newStatus} : v));
            };

            const filteredVars = variables.filter(v => selectedBiz === '全部业务' || v.biz === selectedBiz);

            return (
                <div className="flex h-screen w-screen bg-slate-50 overflow-hidden text-slate-800">
                    <Sidebar />
                    
                    <div className="flex-1 flex flex-col h-screen overflow-hidden">
                        {view === 'LIST' ? (
                            <>
                                {/* List Header */}
                                <header className="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8 shadow-sm z-10 shrink-0">
                                    <div className="font-bold text-lg text-slate-800">变量资产中心</div>
                                    <div className="relative">
                                        <span className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">{Icons.Search}</span>
                                        <input type="text" placeholder="搜索变量..." className="pl-9 pr-4 py-2 bg-slate-100 border-none rounded-full text-sm w-64 focus:ring-2 focus:ring-blue-200 outline-none transition" />
                                    </div>
                                </header>

                                {/* Filters */}
                                <div className="px-8 py-4 flex items-center gap-2 overflow-x-auto shrink-0">
                                    {BIZ_LINES.map(biz => (
                                        <button 
                                            key={biz} 
                                            onClick={() => setSelectedBiz(biz)}
                                            className={`px-4 py-2 rounded-full text-sm font-medium transition whitespace-nowrap ${
                                                selectedBiz === biz ? 'bg-blue-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-100 border border-slate-200'
                                            }`}
                                        >
                                            {biz}
                                        </button>
                                    ))}
                                </div>

                                {/* Table */}
                                <div className="flex-1 overflow-y-auto px-8 pb-8">
                                    <div className="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden">
                                        <table className="w-full text-left text-sm">
                                            <thead className="bg-slate-50 text-slate-500 font-semibold border-b border-slate-200">
                                                <tr>
                                                    <th className="px-6 py-4">变量名称</th>
                                                    <th className="px-6 py-4">加工类型</th>
                                                    <th className="px-6 py-4">业务归属</th>
                                                    <th className="px-6 py-4">状态</th>
                                                    <th className="px-6 py-4 text-right">操作</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-100">
                                                {filteredVars.map(v => {
                                                    const typeConf = VAR_TYPES[v.type];
                                                    return (
                                                        <tr key={v.id} className="hover:bg-slate-50 transition group">
                                                            <td className="px-6 py-4">
                                                                <div className="font-bold text-slate-700">{v.cnName}</div>
                                                                <div className="text-xs font-mono text-slate-400 mt-1">{v.name}</div>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border ${typeConf.color}`}>
                                                                    {typeConf.icon} {typeConf.label}
                                                                </div>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <span className="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded border border-slate-200">{v.biz}</span>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div className="flex items-center gap-2">
                                                                    <span className={`w-2 h-2 rounded-full ${
                                                                        v.status === 'Active' ? 'bg-green-500' : 
                                                                        v.status === 'Testing' ? 'bg-blue-500' : 'bg-slate-400'
                                                                    }`}></span>
                                                                    <span className="text-slate-600 text-xs">{v.status}</span>
                                                                </div>
                                                            </td>
                                                            <td className="px-6 py-4 text-right">
                                                                <button 
                                                                    onClick={() => { setEditingVarId(v.id); setView('EDITOR'); }}
                                                                    className="text-blue-600 hover:text-blue-800 font-medium text-xs bg-blue-50 hover:bg-blue-100 px-3 py-1.5 rounded transition"
                                                                >
                                                                    管理
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                        {filteredVars.length === 0 && <div className="p-8 text-center text-slate-400">暂无数据</div>}
                                    </div>
                                </div>
                            </>
                        ) : (
                            <VariableEditor 
                                variable={activeVar} 
                                onBack={() => setView('LIST')} 
                                onUpdateStatus={handleUpdateStatus}
                            />
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>